<html metal:use-macro="load: head.pt">
<div metal:fill-slot="content" tal:define="basename import: os.path.basename">
<p>Propinquity output documentation. The top-level docs are <a href="../index.html">here</a>.</p>
<p>The <em>labelled_supertree</em> directory holds the final solution trees,
    generated by reattaching the parts of the taxonomy which
    were not covered by any input tree (from
    <a href="../cleaned_ott/index.html">../cleaned_ott/index.html</a>) to the
    grafted solution (see
    <a href="../grafted_solution/index.html">../grafted_solution/index.html</a>).
  </p>

<p><strong>Next step: </strong>Annotate the tree; see
<a href="../annotated_supertree/index.html">../annotated_supertree/index.html</a>
</p>

<p><strong>Results</strong></p>
<p>The input grafted solution had ${'{:,}'.format(unprune_stats.input["num_solution_leaves"])} leaves and
    ${'{:,}'.format(unprune_stats.input["num_solution_splits"])} forking nodes
    (and ${'{:,}'.format(unprune_stats.input["num_solution_internals"] - unprune_stats.input["num_solution_splits"])} monotypic nodes).</p>
<p>The input cleaned taxonomy had ${'{:,}'.format(unprune_stats.input["num_taxonomy_leaves"])} leaves and
    ${'{:,}'.format(unprune_stats.input["num_taxonomy_splits"])} forking nodes
    (and ${'{:,}'.format(unprune_stats.input["num_taxonomy_internals"] - unprune_stats.input["num_taxonomy_splits"])} monotypic nodes).</p>
<p>${'{:,}'.format(unprune_stats.output["num_leaves_added"])} leaves were added in the labelled_supertree step to create the solution.
    ${'{:,}'.format(unprune_stats.output["num_taxa_rejected"])} taxa were rejected.</p>
<p>The files of interest in this directory are (for large files, the link will download the file):
<ul>
    <li>the <a href="./labelled_supertree.tre" download>./labelled_supertree.tre</a> Newick with <code>ott#</code> labels and <code>mrcaott#ott#</code> labels (the latter are created for non-taxonomic internal nodes).</li>
    <li>the <a href="./labelled_supertree_ottnames.tre" download>./labelled_supertree_ottnames.tre</a> the same tree with the <code>name_id</code> format for taxa from OTT.</li>
    <li>the <a href="./broken_taxa.json" download>./broken_taxa.json</a> which describes who
    members of non-monophyletic taxa are spread across the tree.</li>
    <li>the <a href="./input_output_stats.json">./input_output_stats.json</a> which describes the
    size of the tree before and after unpruning the taxonomic content.</li>
    <li>the <a href="./labelled_supertree_out_degree_distribution.txt">./labelled_supertree_out_degree_distribution.txt</a> shows the out-degree frequency distribution
    for the nodes in the labelled supertree</li>
    <li>the <a href="./labelled_supertree_ottnames_without_monotypic.tre" download>./labelled_supertree_ottnames_without_monotypic.tre</a> (if the file exists) is a version of labelled_supertree_ottnames.tre without any taxa that have only one child.</li>
    <li>the <a href="./labelled_supertree_simplified_ottnames.tre" download>./labelled_supertree_simplified_ottnames.tre</a> (if the file exists) is a version of labelled_supertree_ottnames.tre with names simplified to remove characters that cause problems for some clients (using otc-munge-names). The log for this step will be at <a href="simplified_ottnames.log">simplified_ottnames.log</a></li>
    <li>the <a href="./labelled_supertree_simplified_ottnames_without_monotypic.tre" download>./labelled_supertree_simplified_ottnames_without_monotypic.tre</a> (if the file exists) is a version of labelled_supertree_ottnames_without_monotypic.tre with names simplified to remove characters that cause problems for some clients (using otc-munge-names). The log for this step will be at <a href="simplified_ottnames_without_monotypic.log">simplified_ottnames_without_monotypic.log</a></li>
</ul>

<div tal:switch="bool(non_monophyletic_taxa.non_monophyletic_taxa)">
    <div tal:case="True">
        <p >Non-monophyletic taxa: There are ${len(non_monophyletic_taxa.non_monophyletic_taxa)}
        taxa from the Open Tree Taxonomy that are not monophyletic in the synthetic
        tree.</p>
        <table>
            <tr><th>taxon ID</th><th>name</th><th>rank</th><th>MRCA</th><th># attachment points</th><th># intruders</th></tr>
            <tr tal:repeat="id2dict non_monophyletic_taxa.non_monophyletic_taxa.items()">
                <tal:block tal:define="ott_num doc_gen.ott_id_number_str(id2dict[0])">
                    <td><a href="https://tree.opentreeoflife.org/taxonomy/browse?id=${ott_num}" target="_blank">${ott_num}</a></td>
                    <td>${id2dict[1]["name"]}</td>
                    <td>${id2dict[1]["rank"]}</td>
                    <td>${id2dict[1]["mrca"]}</td>
                    <td>${len(id2dict[1]["attachment_points"])}</td>
                    <td>${len(id2dict[1].get("intruding_taxa",[]))}</td>
                </tal:block>
            </tr>
        </table>
    </div>
    <div tal:case="False"><p>Non-monophyletic taxa: There were 0 non-monophyletic taxa</p></div>
</div>
</div>
</html>
